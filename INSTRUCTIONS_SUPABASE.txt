# ğŸ¯ CONFIGURATION SUPABASE CLOUD - Ã‰TAPES PRÃ‰CISES

## ğŸ“‹ CE QUE J'AI BESOIN DE VOUS

### 1. CrÃ©ez un projet Supabase:
   - Allez sur: https://supabase.com/dashboard
   - Cliquez "New Project"
   - Nom: "INF Platform"
   - Choisissez un mot de passe DB
   - RÃ©gion: EU West (ou plus proche)
   - Attendez 2-3 minutes

### 2. RÃ©cupÃ©rez vos credentials:
   - Dans le dashboard, allez Ã  **Settings** â†’ **API**
   - Copiez ces 2 valeurs:
     * **Project URL** (commence par https://)
     * **anon public key** (longue chaÃ®ne de caractÃ¨res)

### 3. Mettez Ã  jour `/frontend/.env.local`:
```env
NEXT_PUBLIC_SUPABASE_URL=https://votre-projet.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=votre-anon-key-ici
```

### 4. ExÃ©cutez les migrations SQL:

#### MIGRATION 1 - Schema Initial
- Dans Supabase: **SQL Editor** â†’ **New Query**
- Copiez-collez le contenu de: `/supabase/migrations/20251101000001_initial_schema.sql`
- Cliquez **RUN** (Ctrl+Enter)
- Attendez le âœ… "Success"

#### MIGRATION 2 - Fonctions
- Nouvelle query
- Copiez-collez le contenu de: `/supabase/migrations/20251101000002_core_functions.sql`
- Cliquez **RUN**
- Attendez le âœ…

#### MIGRATION 3 (OPTIONNEL) - DonnÃ©es de test
```sql
-- Configuration de l'Ã©vÃ©nement
INSERT INTO event_config (
    id,
    event_date,
    phase1_start,
    phase1_end,
    phase2_start,
    phase2_end,
    current_phase
) VALUES (
    1,
    '2025-11-20',
    '2025-11-13 08:00:00+00',
    '2025-11-17 23:59:59+00',
    '2025-11-18 08:00:00+00',
    '2025-11-20 17:00:00+00',
    0
);
```

### 5. Testez l'application:
```bash
cd frontend
npm run dev
```
- Ouvrez http://localhost:3000
- CrÃ©ez un compte Ã©tudiant
- VÃ©rifiez dans Supabase > Authentication que l'utilisateur apparaÃ®t

---

## âœ… CE QUI A Ã‰TÃ‰ FAIT

### Nettoyage:
- âœ… Supabase local arrÃªtÃ©
- âœ… Fichiers Docker temporaires supprimÃ©s
- âœ… Next.js mis Ã  jour vers v16.0.1 (latest)

### Fichiers crÃ©Ã©s:
- âœ… `/frontend/.env.example` - Template de configuration
- âœ… `/SETUP_CLOUD.txt` - Instructions dÃ©taillÃ©es
- âœ… Migrations SQL corrigÃ©es (bug de contrainte fixÃ©)

### Structure actuelle:
```
/workspaces/inf_project/
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ .env.local          â† VOUS: Mettez vos credentials ici
â”‚   â”œâ”€â”€ .env.example        â† Template
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ login/page.tsx
â”‚   â”‚   â”œâ”€â”€ signup/page.tsx
â”‚   â”‚   â”œâ”€â”€ student/page.tsx
â”‚   â”‚   â”œâ”€â”€ company/page.tsx
â”‚   â”‚   â””â”€â”€ admin/page.tsx
â”‚   â”œâ”€â”€ lib/supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts       â† Client Supabase (browser)
â”‚   â”‚   â””â”€â”€ server.ts       â† Client Supabase (server)
â”‚   â””â”€â”€ types/database.ts   â† Types TypeScript
â”‚
â””â”€â”€ supabase/
    â””â”€â”€ migrations/
        â”œâ”€â”€ 20251101000001_initial_schema.sql     â† MIGRATION 1
        â””â”€â”€ 20251101000002_core_functions.sql     â† MIGRATION 2
```

---

## ğŸ”§ VARIABLES D'ENVIRONNEMENT NÃ‰CESSAIRES

Seulement 2 variables dans `/frontend/.env.local`:

```env
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.xxxxx
```

**IMPORTANT**: 
- Le prÃ©fixe `NEXT_PUBLIC_` est obligatoire (Next.js les expose au navigateur)
- RedÃ©marrez `npm run dev` aprÃ¨s modification du `.env.local`

---

## ğŸ“Š MIGRATIONS Ã€ EXÃ‰CUTER

### Option A: Via Supabase Dashboard (RECOMMANDÃ‰)
1. SQL Editor â†’ New Query
2. Copier-coller chaque migration
3. Run

### Option B: Via fichiers (si vous prÃ©fÃ©rez)
Les fichiers sont prÃªts dans `/supabase/migrations/`:
- `20251101000001_initial_schema.sql` (482 lignes)
- `20251101000002_core_functions.sql` (253 lignes)

---

## ğŸ¯ PROCHAINE Ã‰TAPE

**Une fois que vous avez:**
1. âœ… CrÃ©Ã© le projet Supabase
2. âœ… Mis les credentials dans `.env.local`
3. âœ… ExÃ©cutÃ© les 2 migrations

**Alors dites-moi** et on pourra:
- Tester le signup/login
- CrÃ©er un compte admin
- ImplÃ©menter les fonctionnalitÃ©s manquantes
- Tester le systÃ¨me de booking complet

---

## â“ QUESTIONS FRÃ‰QUENTES

**Q: Pourquoi Next.js 16 et pas 14?**
R: Version 16.0.1 est la derniÃ¨re stable (sortie rÃ©cemment). Plus de features et bug fixes.

**Q: Docker est toujours lÃ ?**
R: Oui mais on ne l'utilise plus. Supabase local = lent + pas de collaboration. Cloud = rapide + partageable.

**Q: Les migrations sont diffÃ©rentes du dÃ©but?**
R: Oui, j'ai corrigÃ© un bug (contrainte CHECK avec subquery n'est pas supportÃ©e en PostgreSQL).
